{"version":3,"sources":["src/passwordTolerance.js","src/serverInstructions.js","src/signum.js","src/utils.js"],"names":["PasswordTolerance","[object Object]","passphrase","normalizers","this","actualNormalizers","buildNormalizers","normalizer","normalize","res","lowerCase","push","LowerCaseNormalize","trim","TrimNormalize","whitespacesToDash","WhitespacesToDashNormalize","digitsToSingleZero","DigitsToSingleZeroNormalize","removePunctuation","RemovePunctuationNormalize","toLowerCase","replace","exports","loginConstraints","hashcash","presence","hashcash.require","value","attribute","type","hashcash.zeroCount","require","numericality","onlyInteger","greaterThan","lessThanOrEqualTo","hashcash.serverString","csrfToken","csrfToken.require","passwordToleranConstraints","normalizers.lowerCase","normalizers.trim","normalizers.whitespacesToDash","normalizers.digitsToSingleZero","normalizers.removePunctuation","passphraseMinimalLength","greaterThanOrEqualTo","validate","PasswordToleranceRef","loginFetch","generateHashCash","Signum","username","hashedPasstext","loginUrl","serverInstructions","referer","state","loginFunction","Error","invalidLoginUrl","single","url","allowLocal","JSON","stringify","invalidServerInstructions","format","headers","Content-Type","X-Username","X-hashed-Passtext","zeroCount","serverString","method","body","referrer","length","fetch","crypto","dateFormat","hexToBinary","async","getPublicIp","Promise","resolve","reject","then","response","ok","text","details","json","btoa","input","Buffer","from","toString","ipAddress","timestamp","Date","header","found","binaryHash","randomString","Math","floor","random","Number","MAX_VALUE","counter","hexHash","createHash","update","digest","startsWith","repeat","console","log"],"mappings":"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","file":"js/signum.min.js.map"}